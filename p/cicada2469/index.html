<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <title>Carregar Fase</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
  <style>
    .loader-item {
      color: #fff;
      font-size: 20px;
      background: rgba(255, 255, 255, 0.1);
      padding: 10px 20px;
      border-radius: 5px;
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.5s ease;
    }
body{
  color: wheat;
}
    .loader-item.show {
      opacity: 1;
      transform: translateY(0);
    }
    .fadein{
      opacity: 0;
      animation: fadeInAnimation 1s forwards;
      animation-delay: 0s; /* Delay before the animation starts */
    }
    @keyframes fadeInAnimation {
      to {
        opacity: 1;
      }
    }
  </style>
</head>

<body class="bg-black vh-100 m-0 d-flex flex-column">

  <div class="flex-grow-1 d-flex justify-content-center align-items-center">

    <div id="loaderList" class="d-flex flex-column translate-middle-y align-items-center w-100">
    </div>
    <div class="ani">
      <video ></video>
    </div>
    <div id="conteudo" style="display:none;">
      <h1>Bem-vindo ao jogo!</h1>
    </div>
  </div>
  </div>
  <footer class="py-2 border-top w-100 d-flex justify-content-between px-5" style="height:48px; background:#000; z-index:1000;">
    <p class="h5">0 <i class="bi bi-fire"></i></p>
    <input type="text" name="code" id="code" placeholder="digite o codigo">
    <p class="h5">nivel 1</p>
  </footer>
</body>

<script>
  let loaderItem = $("#loaderList");
  let loaderItemArray = loaderItem.children();
  save = {
    nivel: 1,
    aura: 0
  }

  function addItemLoader(title) {
  loaderItem.append(`
        <div class="d-flex justify-content-between ">
          <p class="m-0 lh-lg">${title}</p>
          <div class="spinner-border mx-2 text-primary" id="loader" role="status"></div>
        </div>
  `)
  loaderItemArray = loaderItem.children();
  }
  function lastItemError() {
    let lastItem = loaderItemArray.last();
    lastItem.find("#loader").attr("class", "fs-4");
    lastItem.find("#loader").html(`<i class=" mx-2 bi bi-x-circle text-danger"></i>`);
  }
  function lastItemSuccess() {
    let lastItem = loaderItemArray.last();
    lastItem.find("#loader").attr("class", "fs-4");
    lastItem.find("#loader").html(`<i class=" mx-2 bi bi-check-circle text-success"></i>`);
  }
  $(function () {


async function verificaLogin() {
  try {
    addItemLoader("Verificando Login...");

    const data = await $.get("../../naoeindex/verificaLogin.php");

    if (data === "1") {
      lastItemSuccess();
      return true;
    } else {
          loaderItem.append(`
    <a class="btn btn-dark mt-3 btn-sm fadein" href="https://furmigueiro.cyou">Fazer Login</a>
      `)
      lastItemError();
      return false;
    }
  } catch (error) {

    lastItemError();
    console.error("Erro na verificação de login:", error);
    return false;
  }
}

async function carregandoDados() {
  try {
    addItemLoader("Carregando Dados...");

    const data = await $.get("bdcicada.php");
console.log(data);
    if (data.dados === "Usuario Criado") {
      lastItemSuccess();
      return true;
    } else {
      console.log(data.dados.nivel);
      lastItemSuccess();
      save = data.dados;
      return true;
    }
  } catch (error) {
    lastItemError();
    console.error("Erro ao carregar dados:", error);
    return false;
  }
}

async function iniciarJogo() {
    const etapas = [verificaLogin, carregandoDados];

    for (let etapa of etapas) {
        let ok = await etapa();
        if (!ok) {
            // Se der erro, interrompe o fluxo
            //return;
        }
    }

    // Se todas passarem
    addItemLoader("Tudo pronto, iniciando o jogo!");

          loaderItem.remove();           // remove o loader do DOM após a animação
          let video = $(".ani video").get(0);
          video.src = `nivel1.mp4`
          video.load()
          video.muted = true;
          video.play()

        $(".ani").fadeOut(1000, function() {
          $("#conteudo").fadeIn(400); // mostra o conteúdo do jogo
carregarniveljquery(1)
        });

}


$("#code").on("change", function(){
  let code = $(this).val();
  if(code === "cesar"){
carregarniveljquery(2)
  } else {
    alert("Codigo invalido");
    $(this).val("");
  }
})
iniciarJogo()
  });
function carregarniveljquery(nivel){
$("#conteudo").load(`nivel${nivel}.html`);
}
</script>

</html>
